;/*FB_PKG_DELIM*/

__d("LSCheckAuthoritativeMessageExists",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.filter(b.db.table(12).fetch([[[a[1]]],"optimistic"]),function(c){return b.i64.eq(c.threadKey,a[0])&&c.offlineThreadingId===a[1]&&b.i64.eq(c.authorityLevel,b.i64.cast([0,80]))}).next().then(function(a,b){b=a.done;a=a.value;return b?c[0]=!1:(a.item,c[0]=!0)})},function(a){return d[0]=c[0]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxCheckAuthoritativeMessageExistsStoredProcedure";e.exports=a}),null);
__d("LSInsertMessage",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.i64.eq(a[2],b.i64.cast([0,20]))?b.db.table(12).add({threadKey:a[3],timestampMs:a[5],messageId:a[8],offlineThreadingId:a[9],authorityLevel:a[2],primarySortKey:a[6],senderId:a[10],isAdminMessage:a[12],sendStatus:a[15],sendStatusV2:a[16],text:a[0],subscriptErrorMessage:a[1],secondarySortKey:a[7],stickerId:a[11],messageRenderingType:a[13],isUnsent:a[17],unsentTimestampMs:a[18],mentionOffsets:a[19],mentionLengths:a[20],mentionIds:a[21],mentionTypes:a[22],replySourceId:a[23],replySourceType:a[24],replySourceTypeV2:a[25],replyStatus:a[26],replySnippet:a[27],replyMessageText:a[28],replyToUserId:a[29],replyMediaExpirationTimestampMs:a[30],replyMediaUrl:a[31],replyMediaPreviewWidth:a[33],replyMediaPreviewHeight:a[34],replyMediaUrlMimeType:a[35],replyMediaUrlFallback:a[36],replyCtaId:a[37],replyCtaTitle:a[38],replyAttachmentType:a[39],replyAttachmentId:a[40],replyAttachmentExtra:a[41],isForwarded:a[42],forwardScore:a[43],hasQuickReplies:a[44],adminMsgCtaId:a[45],adminMsgCtaTitle:a[46],adminMsgCtaType:a[47],cannotUnsendReason:a[48],textHasLinks:a[49],viewFlags:a[50],displayedContentTypes:a[51],viewedPluginKey:a[52],viewedPluginContext:a[53],quickReplyType:a[54],hotEmojiSize:a[55],platformXmdEncoded:a[56],replySourceTimestampMs:a[57],ephemeralDurationInSec:a[58],msUntilExpirationTs:a[59],ephemeralExpirationTs:a[60],takedownState:a[61],isCollapsed:a[62],subthreadKey:a[63],botResponseId:a[64],metadataDataclass:a[65],editCount:a[66],isPaidPartnership:a[67],adminSignatureName:a[68],adminSignatureProfileUrl:a[69],adminSignatureCreatorType:a[70]}):b.sequence([function(d){return b.db.table(12).fetch([[[a[9]]],"optimistic"]).next().then(function(b,d){var e=b.done;b=b.value;return e?(e=[a[6],a[7],void 0],c[0]=e[0],c[1]=e[1],c[2]=e[2],e):(d=b.item,e=[d.primarySortKey,d.secondarySortKey,d.localDataId],c[0]=e[0],c[1]=e[1],c[2]=e[2],e)})},function(c){return b.forEach(b.filter(b.db.table(12).fetch([[[a[9]]],"optimistic"]),function(c){return c.offlineThreadingId===a[9]&&b.i64.lt(c.authorityLevel,a[2])}),function(a){return a["delete"]()})},function(d){return b.db.table(12).add({threadKey:a[3],timestampMs:a[5],messageId:a[8],offlineThreadingId:a[9],authorityLevel:a[2],primarySortKey:c[0],senderId:a[10],isAdminMessage:a[12],sendStatus:a[15],sendStatusV2:a[16],text:a[0],subscriptErrorMessage:a[1],secondarySortKey:c[1],stickerId:a[11],messageRenderingType:a[13],isUnsent:a[17],unsentTimestampMs:a[18],mentionOffsets:a[19],mentionLengths:a[20],mentionIds:a[21],mentionTypes:a[22],replySourceId:a[23],replySourceType:a[24],replySourceTypeV2:a[25],replyStatus:a[26],replySnippet:a[27],replyMessageText:a[28],replyToUserId:a[29],replyMediaExpirationTimestampMs:a[30],replyMediaUrl:a[31],replyMediaPreviewWidth:a[33],replyMediaPreviewHeight:a[34],replyMediaUrlMimeType:a[35],replyMediaUrlFallback:a[36],replyCtaId:a[37],replyCtaTitle:a[38],replyAttachmentType:a[39],replyAttachmentId:a[40],replyAttachmentExtra:a[41],isForwarded:a[42],forwardScore:a[43],hasQuickReplies:a[44],adminMsgCtaId:a[45],adminMsgCtaTitle:a[46],adminMsgCtaType:a[47],cannotUnsendReason:a[48],textHasLinks:a[49],viewFlags:a[50],displayedContentTypes:a[51],viewedPluginKey:a[52],viewedPluginContext:a[53],quickReplyType:a[54],hotEmojiSize:a[55],platformXmdEncoded:a[56],replySourceTimestampMs:a[57],ephemeralDurationInSec:a[58],msUntilExpirationTs:a[59],ephemeralExpirationTs:a[60],takedownState:a[61],isCollapsed:a[62],subthreadKey:a[63],botResponseId:a[64],metadataDataclass:a[65],editCount:a[66],isPaidPartnership:a[67],adminSignatureName:a[68],adminSignatureProfileUrl:a[69],adminSignatureCreatorType:a[70],localDataId:c[2]})}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxInsertMessageStoredProcedure";e.exports=a}),null);
__d("LSUpdateParticipantLastMessageSendTimestamp",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.resolve(c)}a.__sproc_name__="LSMailboxUpdateParticipantLastMessageSendTimestampStoredProcedure";e.exports=a}),null);